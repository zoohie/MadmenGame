import {BaseAction} from "../../../core/engine/fsm/BaseAction";
import {ModalPopupEvents} from "../events/ModalPopupEvents";
import {getModel} from "../../../core/engine/createInstance";
import {CoreInitParamsModel} from "../../server/models/CoreInitParamsModel";

export class AdultResposibiltyPopupAction extends BaseAction {
    protected initParamsModel: CoreInitParamsModel = getModel(this, CoreInitParamsModel) as CoreInitParamsModel;

    execute(): Promise<any> {
        if (!this.initParamsModel.showAdultResponsibility) {
            return Promise.resolve();
        }

        return new Promise<any>((resolve) => {
            this.dispatcher.once(ModalPopupEvents.YES_BUTTON_PRESSED, () => {
                this.dispatcher.dispatch(ModalPopupEvents.HIDE_YES_NO_POPUP);
                resolve();
            });

            this.dispatcher.once(ModalPopupEvents.NO_BUTTON_PRESSED, () => {
                //this.dispatcher.dispatch(ModalPopupEvents.HIDE_YES_NO_POPUP);
                window.location.reload();
            });

            this.dispatcher.dispatch(ModalPopupEvents.SHOW_YES_NO_POPUP);
        });
    }
}
