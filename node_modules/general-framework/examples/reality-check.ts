import {
    ModalPopup,
    RealityCheck,
    CoreEvents,
    EventDispatcher,
    ModalPopupEvents,
    RealityCheckData
} from 'general-framework';

const dispatcher = EventDispatcher.getInstance();

// get these params on INIT event
// keys have the correct spelling, values added for example
const params = {
    lang: 'en',
    time_elapsed: 1,
    time_limit: 2,
    exit_URL: 'https://google.com',
};

// context
// initialization classes that needed to use realty check
const modal = new ModalPopup();
new RealityCheck();

// insert styles for popup into html head
// run it once on a project!
modal.insertPopupStyles();

// expected that it action will be async (POST request)
Promise.resolve(dispatcher.dispatch(CoreEvents.ON_INIT_RECEIVED, params));

// if listener on FREEZE_GAME will be added asynchronously
// follow that it occurred before dispatched ON_INIT_RECEIVED event
dispatcher.addListener(CoreEvents.FREEZE_GAME, () => {
    // FREEZE_GAME saying that must be shown popup with reality check
    // if there are some processes that must be finished before popup will be shown,
    // wait for it and then show popup

    // action 1
    // action 2
    // action 3
    Promise.resolve(dispatcher.dispatch(ModalPopupEvents.SHOW_MODAL_POPUP, RealityCheckData.getData()));
});

